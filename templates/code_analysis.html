<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Developer's Toolkit - Code Analysis</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
    <style>
        :root {
            --primary-color: #4a6cf7;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --info-color: #17a2b8;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fb;
            color: #333;
        }
        
        .navbar {
            background-color: #fff;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
        }
        
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }
        
        .card-header {
            background-color: transparent;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            padding: 15px 20px;
        }
        
        .card-body {
            padding: 20px;
        }
        
        .code-container {
            background-color: #282c34;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #abb2bf;
        }
        
        .code-title {
            font-weight: 600;
        }
        
        .code-actions button {
            background: none;
            border: none;
            color: #abb2bf;
            margin-left: 10px;
            cursor: pointer;
        }
        
        .code-actions button:hover {
            color: #fff;
        }
        
        pre {
            margin: 0;
            padding: 0;
            background: none;
        }
        
        .analysis-results {
            margin-top: 20px;
        }
        
        .issue-item {
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            background-color: rgba(220, 53, 69, 0.1);
            border-left: 4px solid var(--danger-color);
        }
        
        .issue-item.warning {
            background-color: rgba(255, 193, 7, 0.1);
            border-left: 4px solid var(--warning-color);
        }
        
        .issue-item.info {
            background-color: rgba(23, 162, 184, 0.1);
            border-left: 4px solid var(--info-color);
        }
        
        .issue-item h6 {
            margin-bottom: 5px;
        }
        
        .issue-item p {
            margin-bottom: 0;
            font-size: 0.9rem;
        }
        
        .file-tree {
            list-style: none;
            padding-left: 0;
        }
        
        .file-tree li {
            padding: 5px 0;
        }
        
        .file-tree a {
            color: #333;
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        
        .file-tree a:hover {
            color: var(--primary-color);
        }
        
        .file-tree i {
            margin-right: 5px;
        }
        
        .dark-mode {
            background-color: #1a1a2e;
            color: #e6e6e6;
        }
        
        .dark-mode .navbar, .dark-mode .card {
            background-color: #16213e;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        }
        
        .dark-mode .card-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .dark-mode .file-tree a {
            color: #e6e6e6;
        }
        
        .dark-mode .file-tree a:hover {
            color: #4a6cf7;
        }
        
        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Developer's Toolkit</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="#">Code Analysis</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Terminal</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Git</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Settings</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <div class="container-fluid mt-4">
        <div class="row">
            <!-- File Tree -->
            <div class="col-md-3">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Project Files</h5>
                    </div>
                    <div class="card-body">
                        <ul class="file-tree">
                            <li>
                                <a href="#"><i class="bi bi-folder"></i> src</a>
                                <ul class="file-tree ms-3">
                                    <li>
                                        <a href="#"><i class="bi bi-file-earmark-code"></i> main.py</a>
                                    </li>
                                    <li>
                                        <a href="#"><i class="bi bi-file-earmark-code"></i> mcp_server.py</a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <a href="#"><i class="bi bi-folder"></i> templates</a>
                                <ul class="file-tree ms-3">
                                    <li>
                                        <a href="#"><i class="bi bi-file-earmark-text"></i> index.html</a>
                                    </li>
                                    <li>
                                        <a href="#"><i class="bi bi-file-earmark-text"></i> dashboard.html</a>
                                    </li>
                                    <li>
                                        <a href="#"><i class="bi bi-file-earmark-text"></i> code_analysis.html</a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <a href="#"><i class="bi bi-file-earmark-text"></i> requirements.txt</a>
                            </li>
                            <li>
                                <a href="#"><i class="bi bi-file-earmark-text"></i> README.md</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Code Analysis -->
            <div class="col-md-9">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Code Analysis</h5>
                        <div>
                            <button class="btn btn-sm btn-primary me-2">Analyze</button>
                            <button class="btn btn-sm btn-outline-secondary">Export</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="code-container">
                            <div class="code-header">
                                <div class="code-title">main.py</div>
                                <div class="code-actions">
                                    <button title="Copy"><i class="bi bi-clipboard"></i></button>
                                    <button title="Download"><i class="bi bi-download"></i></button>
                                </div>
                            </div>
                            <pre><code class="language-python">import os
import sys
import logging
from fastapi import FastAPI, Request, HTTPException
from fastapi.responses import HTMLResponse
from fastapi.staticfiles import StaticFiles
from fastapi.templating import Jinja2Templates
from datetime import datetime
from pydantic import BaseModel, Field
import base64
import json

# --- Configuration ---
DEFAULT_PORT = 9998
TEMPLATES_DIR = "templates"
STATIC_DIR = "static"

# --- Logging ---
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(name)s - %(levelname)s - %(message)s')
logger = logging.getLogger("DevToolkitServer")

# --- App ---
app = FastAPI(
    title="Developer's Toolkit",
    description="A toolkit for developers with MCP integration",
    version="1.0.0"
)

# Mount static files
app.mount("/static", StaticFiles(directory=STATIC_DIR), name="static")

# Templates
templates = Jinja2Templates(directory=TEMPLATES_DIR)

# --- Routes ---
@app.get("/", response_class=HTMLResponse)
async def read_root(request: Request, port: int = DEFAULT_PORT):
    """Serves the main HTML page."""
    # MCP connection info
    mcp_port = 9999  # The port where MCP proxy runs
    mcp_connection = {
        "type": "mcp",
        "version": "2024-11-05",
        "endpoint": f"http://127.0.0.1:{mcp_port}/messages/",
        "id": "f086541b-6b70-4a20-a1ce-96ca927e0a74",
        "name": "Developer's Toolkit"
    }
    
    # Convert to base64 for cursor URL
    cursor_url_data = base64.b64encode(json.dumps(mcp_connection).encode()).decode()
    
    connection_info = {
        "cursor_url": f"cursor://connect/{cursor_url_data}",
        "cli_command": f"mcp-proxy --sse-port {mcp_port} -- python mcp_server.py"
    }
    
    # Make sure index.html exists
    index_path = os.path.join(TEMPLATES_DIR, "index.html")
    if not os.path.exists(index_path):
         logger.error(f"Template file not found: {index_path}")
         raise HTTPException(status_code=500, detail="Server configuration error: Template not found.")

    return templates.TemplateResponse(
        "index.html",
        {
            "request": request, 
            "connection_info": connection_info, 
            "toolkit_version": app.version,
            "current_year": datetime.now().year
        }
    )</code></pre>
                        </div>
                        
                        <div class="analysis-results">
                            <h5>Analysis Results</h5>
                            
                            <div class="issue-item">
                                <h6>Line 42: Unused import</h6>
                                <p>The 'sys' module is imported but never used in the code.</p>
                            </div>
                            
                            <div class="issue-item warning">
                                <h6>Line 65: Hardcoded port number</h6>
                                <p>Consider using an environment variable or configuration file for the port number.</p>
                            </div>
                            
                            <div class="issue-item info">
                                <h6>Line 78: Missing type hints</h6>
                                <p>Consider adding type hints to the function parameters for better code readability.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- MCP Connection -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">MCP Connection</h5>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info">
                            <h6>Connection URL</h6>
                            <p class="mb-0">{{ connection_info.cursor_url }}</p>
                        </div>
                        <div class="alert alert-secondary">
                            <h6>CLI Command</h6>
                            <p class="mb-0"><code>{{ connection_info.cli_command }}</code></p>
                        </div>
                        <p class="text-muted">Connect to the MCP server from Cursor using the connection URL above.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Theme Toggle Button -->
    <button class="btn btn-primary rounded-circle theme-toggle" id="themeToggle">
        <i class="bi bi-moon-fill"></i>
    </button>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>
        // Initialize syntax highlighting
        hljs.highlightAll();
        
        // Theme toggle functionality
        document.getElementById('themeToggle').addEventListener('click', function() {
            document.body.classList.toggle('dark-mode');
            const icon = this.querySelector('i');
            if (document.body.classList.contains('dark-mode')) {
                icon.classList.remove('bi-moon-fill');
                icon.classList.add('bi-sun-fill');
            } else {
                icon.classList.remove('bi-sun-fill');
                icon.classList.add('bi-moon-fill');
            }
        });
    </script>
</body>
</html> 