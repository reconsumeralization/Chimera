<!DOCTYPE html>
<html lang="en" data-theme="{{ theme }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Developer's Toolkit | Ultimate Coding Experience</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <!-- Prism JS (Syntax Highlighting) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <!-- Particle.js for mad scientist effects -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <!-- Animate.css for wild animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script>
        // Basic Tailwind config (can be extended)
        tailwind.config = {
            darkMode: 'class',
             theme: {
                 extend: { 
                     colors: {
                         primary: {
                             400: '#3b82f6',
                             500: '#3b82f6',
                             600: '#2563eb',
                             700: '#1d4ed8'
                         },
                         secondary: {
                             400: '#8b5cf6',
                             500: '#8b5cf6',
                             600: '#7c3aed',
                             700: '#6d28d9'
                         },
                         toxic: {
                             400: '#4ade80',
                             500: '#22c55e',
                             600: '#16a34a'
                         }
                     },
                     animation: {
                        'pulse-fast': 'pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'spin-slow': 'spin 3s linear infinite',
                        'bounce-slow': 'bounce 3s infinite'
                     }
                 }
             }
        }
    </script>
    <style>
        /* Small CSS tweaks if needed */
        .code-editor {
            font-family: 'Fira Code', 'Cascadia Code', 'Courier New', monospace;
            font-size: 0.9em; /* Slightly smaller for editor feel */
            min-height: 10rem; /* Ensure textarea has some initial height */
        }
        /* Prism line numbers alignment */
        .line-numbers .line-numbers-rows { padding-left: 3.8rem !important; }
        /* Loading spinner */
        .loader {
            border: 4px solid #f3f3f3; /* Light grey */
            border-top: 4px solid #3498db; /* Blue */
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block; /* Or 'block' with margin auto */
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* Mad Scientist Effects */
        .tesla-effect {
            position: relative;
            overflow: hidden;
        }
        .tesla-effect::before {
            content: '';
            position: absolute;
            top: -10%;
            left: -10%;
            width: 120%;
            height: 120%;
            background-image: url('/static/img/lightning.svg');
            opacity: 0;
            pointer-events: none;
            z-index: 10;
            animation: tesla-flash 7s infinite;
        }
        @keyframes tesla-flash {
            0%, 95%, 98% { opacity: 0; }
            96%, 97% { opacity: 0.3; }
        }
        
        /* Bubbling beaker effect */
        .bubbling-beaker {
            position: relative;
        }
        .bubble {
            position: absolute;
            bottom: 0;
            background: rgba(127, 255, 212, 0.2);
            border-radius: 50%;
            animation: bubble-rise 4s infinite ease-in;
            opacity: 0;
        }
        @keyframes bubble-rise {
            0% { transform: translateY(0); opacity: 0; }
            10% { opacity: 0.8; }
            90% { opacity: 0.4; }
            100% { transform: translateY(-100px); opacity: 0; }
        }
        
        /* Glowing text effect */
        .glow-text {
            text-shadow: 0 0 5px rgba(66, 220, 163, 0.7), 
                         0 0 10px rgba(66, 220, 163, 0.5), 
                         0 0 15px rgba(66, 220, 163, 0.3);
            animation: glow-pulse 2s infinite alternate;
        }
        @keyframes glow-pulse {
            from { text-shadow: 0 0 5px rgba(66, 220, 163, 0.7), 
                              0 0 10px rgba(66, 220, 163, 0.5), 
                              0 0 15px rgba(66, 220, 163, 0.3); }
            to { text-shadow: 0 0 10px rgba(66, 220, 163, 0.9), 
                            0 0 20px rgba(66, 220, 163, 0.7), 
                            0 0 30px rgba(66, 220, 163, 0.5); }
        }
        
        /* Particles container */
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            pointer-events: none;
        }
    </style>
    <meta name="description" content="{{ description }}">
    <meta name="version" content="{{ version }}">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="{{ bootstrap_css }}">
    <link rel="stylesheet" href="{{ bootstrap_icons }}">
    <link rel="stylesheet" href="{{ app_css }}">
    <link rel="stylesheet" href="{{ services_css }}">
    <link rel="stylesheet" href="{{ theme_transition_css }}">
    <link rel="stylesheet" href="{{ notifications_css }}">
    <link rel="stylesheet" href="{{ animations_css }}">
    <link rel="stylesheet" href="{{ keyboard_css }}">
    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #000000;
            --border-color: #e0e0e0;
            --accent-color: #3b82f6;
            --accent-glow: rgba(59, 130, 246, 0.5);
        }
        
        [data-theme="dark"] {
            --bg-color: #0a0e12;
            --text-color: #ffffff;
            --border-color: #1e2a35;
            --accent-color: #39ff14;
            --accent-glow: rgba(57, 255, 20, 0.6);
        }
        
        /* Quick fixes for better look */
        [data-theme="dark"] .bg-dark {
            background-color: rgba(0, 0, 0, 0.7) !important;
        }
        
        [data-theme="dark"] .text-muted {
            color: rgba(57, 255, 20, 0.7) !important;
        }
        
        [data-theme="dark"] .bg-light {
            background-color: rgba(0, 0, 0, 0.5) !important;
        }
        
        [data-theme="dark"] .dropdown-menu {
            background-color: rgba(10, 14, 18, 0.9);
            border: 1px solid rgba(57, 255, 20, 0.2);
            box-shadow: 0 0 15px rgba(57, 255, 20, 0.2);
        }
        
        [data-theme="dark"] .dropdown-item {
            color: #ffffff;
        }
        
        [data-theme="dark"] .dropdown-item:hover {
            background-color: rgba(57, 255, 20, 0.1);
        }
    </style>
</head>
<body>
    <div id="particles-container"></div>
    
    <div class="matrix-code-rain"></div>
    
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark animate-fade-in">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="bi bi-braces"></i>
                <span class="ms-2">{{ title }}</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#dashboard">
                            <i class="bi bi-speedometer2"></i>
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#code-analysis">
                            <i class="bi bi-code-square"></i>
                            Code Analysis
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#terminal">
                            <i class="bi bi-terminal"></i>
                            Terminal
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#git">
                            <i class="bi bi-git"></i>
                            Git
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#settings">
                            <i class="bi bi-gear"></i>
                            Settings
                        </a>
                    </li>
                </ul>
                <div class="ms-auto d-flex align-items-center">
                    <button id="theme-toggle" class="btn btn-outline-light me-2">
                        <i class="bi bi-sun"></i>
                    </button>
                    <span class="badge bg-dark border border-light">v{{ version }}</span>
                </div>
            </div>
        </div>
    </nav>

    <main class="container mt-4 animate-fade-in">
        <div id="main-content">
            <!-- Welcome content will be shown when nothing else is loaded -->
            <div class="text-center py-5">
                <h1 class="display-4 mb-4">Welcome to {{ title }}</h1>
                <p class="lead mb-5">Your advanced AI-powered coding assistant</p>
                
                <div class="row justify-content-center">
                    <div class="col-md-3 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-code-square fs-1 mb-3"></i>
                                <h5 class="card-title">Code Analysis</h5>
                                <p class="card-text">Analyze your code for issues and improvements</p>
                                <a href="#code-analysis" class="btn btn-primary">Analyze Code</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-terminal fs-1 mb-3"></i>
                                <h5 class="card-title">Terminal</h5>
                                <p class="card-text">Execute commands and manage your project</p>
                                <a href="#terminal" class="btn btn-primary">Open Terminal</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-git fs-1 mb-3"></i>
                                <h5 class="card-title">Git Operations</h5>
                                <p class="card-text">Manage your git repositories with ease</p>
                                <a href="#git" class="btn btn-primary">Git Tools</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-gear fs-1 mb-3"></i>
                                <h5 class="card-title">Settings</h5>
                                <p class="card-text">Customize your experience</p>
                                <a href="#settings" class="btn btn-primary">Configure</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer mt-auto py-3 bg-light animate-fade-in">
        <div class="container text-center">
            <span class="text-muted">© {{ current_year }} {{ title }} v{{ version }}</span>
        </div>
    </footer>

    <script src="{{ bootstrap_js }}"></script>
    <script src="{{ particles_js }}"></script>
    <script src="{{ utils_js }}"></script>
    <script src="{{ theme_js }}"></script>
    <script src="{{ notifications_js }}"></script>
    <script src="{{ animations_js }}"></script>
    <script src="{{ keyboard_js }}"></script>
    <script src="{{ services_js }}"></script>
    <script src="{{ app_js }}"></script>
    <script src="{{ mcp_checker_js }}"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize theme
            if (typeof ThemeManager !== 'undefined') {
                ThemeManager.init();
            }
            
            // Get feature flags from data attributes to avoid Jinja2 template issues
            const featureFlags = {
                notifications: JSON.parse('{{ notifications_enabled|default("true")|tojson|safe }}'),
                animations: JSON.parse('{{ animations_enabled|default("true")|tojson|safe }}'),
                keyboard: JSON.parse('{{ keyboard_enabled|default("true")|tojson|safe }}')
            };
            
            // Initialize features based on server settings
            if (featureFlags.notifications && typeof initNotifications === 'function') {
                initNotifications();
            }
            
            if (featureFlags.animations && typeof initAnimations === 'function') {
                initAnimations();
            }
            
            if (featureFlags.keyboard && typeof initKeyboardShortcuts === 'function') {
                initKeyboardShortcuts();
            }
            
            // Initialize app if it exists
            if (typeof AppManager !== 'undefined') {
                AppManager.init();
            }
            
            // Check if matrix effect should be enabled
            if (featureFlags.animations) {
                createMatrixRain();
            }
        });
        
        // Matrix code rain effect
        function createMatrixRain() {
            var canvas = document.createElement('canvas');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            canvas.style.position = 'fixed';
            canvas.style.top = '0';
            canvas.style.left = '0';
            canvas.style.zIndex = '-1';
            canvas.style.pointerEvents = 'none';
            canvas.style.opacity = '0.05';
            document.querySelector('.matrix-code-rain').appendChild(canvas);
            
            var ctx = canvas.getContext('2d');
            
            // Matrix characters
            var chars = '01αβγδεζηθικλμνξοπρστυφχψωΓΔΘΛΞΠΣΦΨΩ⟨⟩⌈⌉⌊⌋∀∁∃∄∅∆∇∈∉∍∎∏∐∑−∓∔∕∖∗∘∙√∛∜∝∞∟∠∡∢∣∤∥∦∧∨∩∪∫∬∭∮∯∰∱∲∳∴∵∶∷∸∹∺∻∼∾∿⊀⊁⊂⊃⊄⊅⊆⊇⊈⊉⊊⊋⊌⊍⊎⊏⊐⊑⊒⊓⊔⊕⊖⊗⊘⊙⊚⊛⊜⊝⊞⊟⊠⊡⊢⊣⊤⊥⊦⊧⊨⊩⊪⊫⊬⊭⊮⊯⊰⊱⊲⊳⊴⊵⊶⊷⊸⊹⊺⊻⊼⊽⊾⊿⋀⋁⋂⋃⋄⋅⋆⋇⋈⋉⋊⋋⋌⋍⋎⋏⋐⋑⋒⋓⋔⋕⋖⋗⋘⋙⋚⋛⋜⋝⋞⋟⋠⋡⋢⋣⋤⋥⋦⋧⋨⋩⋪⋫⋬⋭⋮⋯⋰⋱⋲⋳⋴⋵⋶⋷⋸⋹⋺⋻⋼⋽⋾⋿';
            
            // Rain drops
            var drops = [];
            var columnCount = Math.floor(canvas.width / 20);
            
            for (var i = 0; i < columnCount; i++) {
                drops[i] = Math.floor(Math.random() * -canvas.height);
            }
            
            function draw() {
                // Semi-transparent black background for trail effect
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#39ff14';
                ctx.font = '20px monospace';
                
                for (var i = 0; i < drops.length; i++) {
                    // Get a random matrix character
                    var char = chars.charAt(Math.floor(Math.random() * chars.length));
                    
                    // Draw the character
                    ctx.fillText(char, i * 20, drops[i] * 20);
                    
                    // Move drop position
                    if (drops[i] * 20 > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    
                    drops[i]++;
                }
                
                requestAnimationFrame(draw);
            }
            
            draw();
            
            // Resize canvas on window resize
            window.addEventListener('resize', function() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });
        }
    </script>
</body>
</html>